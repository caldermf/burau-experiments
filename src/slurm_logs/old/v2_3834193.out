============================================================
SEARCHING FOR p=5 KERNEL ELEMENTS (ULTRA-OPTIMIZED v2)
============================================================
Device: cuda
Bucket size: 1000000
Max length: 60
Bootstrap length: 5
Prime: 5
Degree multiplier: 4
Degree window: 481
Use best: 500000
Expansion chunk size: 50000
Matmul chunk size: 11000
GC every N chunks: 4
⚡ v2 optimizations: reduced GC, fused projlen

Loaded tables from /nfs/roberts/project/pi_com36/com36/burau-experiments/precomputed_tables/tables_B4_r1_p5.pt
  Degree window: 481
✓ Identity matrix verified

Precomputing FFTs of simple Burau matrices...
  D=481, fft_size=1024
  FFT cache: 0.9 MB
Initialized with identity braid
Degree window: [-240, 240] (481 coefficients)
FFT size: 1024
Storage types: matrix=torch.int16, word=torch.int32
Config: bucket_size=1000000, bootstrap=5, max_length=60, chunk_size=50000, matmul_chunk=11000, use_best=500000, gc_every=4
⚡ Ultra-optimized v2: reduced GC, fused projlen

============================================================
Level 1 - BOOTSTRAP
============================================================
  Starting braids: 1 (gather: 0.03s)
  Candidates to generate: 22 (expand_idx: 0.05s)
  Projlen distribution:
    projlen=3: 10 braids
    projlen=4: 12 braids
  Braids kept: 22 (in 2 buckets, 0.00 GB)
  ⚡ Timing: matmul=0.05s, sample+projlen=0.03s, gather=0.03s, expand=0.05s, other=0.05s, total=0.21s

============================================================
Level 2 - BOOTSTRAP
============================================================
  Starting braids: 22 (gather: 0.00s)
  Candidates to generate: 164 (expand_idx: 0.00s)
  Projlen distribution:
    projlen=5: 56 braids
    projlen=6: 76 braids
    projlen=7: 32 braids
  Braids kept: 164 (in 3 buckets, 0.00 GB)
  ⚡ Timing: matmul=0.01s, sample+projlen=0.00s, gather=0.00s, expand=0.00s, other=0.05s, total=0.06s

============================================================
Level 3 - BOOTSTRAP
============================================================
  Starting braids: 164 (gather: 0.00s)
  Candidates to generate: 982 (expand_idx: 0.00s)
  Projlen distribution:
    projlen=7: 270 braids
    projlen=8: 364 braids
    projlen=9: 288 braids
    projlen=10: 60 braids
  Braids kept: 982 (in 4 buckets, 0.01 GB)
  ⚡ Timing: matmul=0.01s, sample+projlen=0.00s, gather=0.00s, expand=0.00s, other=0.05s, total=0.06s

============================================================
Level 4 - BOOTSTRAP
============================================================
  Starting braids: 982 (gather: 0.00s)
  Candidates to generate: 5528 (expand_idx: 0.00s)
  Projlen distribution:
    projlen=9: 1256 braids
    projlen=10: 1672 braids
    projlen=11: 1784 braids
    projlen=12: 700 braids
    projlen=13: 116 braids
  Braids kept: 5528 (in 5 buckets, 0.05 GB)
  ⚡ Timing: matmul=0.02s, sample+projlen=0.00s, gather=0.00s, expand=0.00s, other=0.05s, total=0.07s

============================================================
Level 5 - BOOTSTRAP
============================================================
  Starting braids: 5528 (gather: 0.00s)
  Candidates to generate: 30478 (expand_idx: 0.00s)
  Projlen distribution:
    projlen=10: 4 braids
    projlen=11: 5798 braids
    projlen=12: 7672 braids
    projlen=13: 9864 braids
    projlen=14: 5236 braids
    projlen=15: 1716 braids
    projlen=16: 188 braids
  Braids kept: 30478 (in 7 buckets, 0.27 GB)
  ⚡ Timing: matmul=0.08s, sample+projlen=0.00s, gather=0.00s, expand=0.00s, other=0.06s, total=0.14s

============================================================
Level 6 - SAMPLING
============================================================
  Starting braids: 30478 (gather: 0.00s)
  Candidates to generate: 166796 (expand_idx: 0.00s)
  Processing in 4 chunks...
  Projlen distribution:
    projlen=12: 68 braids
    projlen=13: 26768 braids
    projlen=14: 35288 braids
    projlen=15: 52292 braids
    projlen=16: 33012 braids
    projlen=17: 15680 braids
    projlen=18: 3356 braids
    projlen=19: 332 braids
  Braids kept: 166796 (in 8 buckets, 1.48 GB)
  ⚡ Timing: matmul=0.17s, sample+projlen=0.24s, gather=0.00s, expand=0.00s, other=0.06s, total=0.47s

============================================================
Level 7 - SAMPLING
============================================================
  Starting braids: 166796 (gather: 0.01s)
  Candidates to generate: 910366 (expand_idx: 0.00s)
  Processing in 19 chunks...
  Projlen distribution:
    projlen=13: 52 braids
    projlen=14: 716 braids
    projlen=15: 123766 braids
    projlen=16: 162616 braids
    projlen=17: 271412 braids
    projlen=18: 191940 braids
    projlen=19: 116516 braids
    projlen=20: 35764 braids
    projlen=21: 7076 braids
    projlen=22: 508 braids
  Braids kept: 910366 (in 10 buckets, 8.10 GB)
  ⚡ Timing: matmul=0.15s, sample+projlen=2.18s, gather=0.01s, expand=0.00s, other=0.36s, total=2.70s

============================================================
Level 8 - SAMPLING
============================================================
  Starting braids: 500000 (gather: 0.04s)
  Candidates to generate: 2793706 (expand_idx: 0.00s)
  Processing in 56 chunks...
  Projlen distribution:
    projlen=14: 112 braids
    projlen=15: 892 braids
    projlen=16: 6090 braids
    projlen=17: 567109 braids
    projlen=18: 725767 braids
    projlen=19: 1090643 braids
    projlen=20: 403093 braids
  Braids kept: 2703063 (in 7 buckets, 24.06 GB)
  ⚡ Timing: matmul=0.46s, sample+projlen=7.26s, gather=0.04s, expand=0.00s, other=1.37s, total=9.13s

============================================================
Level 9 - SAMPLING
============================================================
  Starting braids: 500000 (gather: 0.03s)
  Candidates to generate: 2973392 (expand_idx: 0.00s)
  Processing in 60 chunks...
  Projlen distribution:
    projlen=15: 151 braids
    projlen=16: 1273 braids
    projlen=17: 11034 braids
    projlen=18: 33888 braids
    projlen=19: 1949537 braids
    projlen=20: 977509 braids
  Braids kept: 2023855 (in 6 buckets, 18.02 GB)
  ⚡ Timing: matmul=0.51s, sample+projlen=8.34s, gather=0.03s, expand=0.00s, other=4.00s, total=12.89s

============================================================
Level 10 - SAMPLING
============================================================
  Starting braids: 500000 (gather: 0.00s)
  Candidates to generate: 3026574 (expand_idx: 0.01s)
  Processing in 61 chunks...
  Projlen distribution:
    projlen=16: 63 braids
    projlen=17: 2815 braids
    projlen=18: 9734 braids
    projlen=19: 75572 braids
    projlen=20: 151709 braids
    projlen=21: 1861453 braids
    projlen=22: 925228 braids
  Braids kept: 2165121 (in 7 buckets, 19.27 GB)
  ⚡ Timing: matmul=0.47s, sample+projlen=8.51s, gather=0.00s, expand=0.01s, other=1.80s, total=10.79s

============================================================
Level 11 - SAMPLING
============================================================
  Starting braids: 500000 (gather: 0.00s)
  Candidates to generate: 3063544 (expand_idx: 0.01s)
  Processing in 62 chunks...
  Projlen distribution:
    projlen=16: 6 braids
    projlen=17: 89 braids
    projlen=18: 1324 braids
    projlen=19: 24288 braids
    projlen=20: 56807 braids
    projlen=21: 425456 braids
    projlen=22: 653025 braids
    projlen=23: 1363886 braids
    projlen=24: 538663 braids
  Braids kept: 2699658 (in 9 buckets, 24.03 GB)
  ⚡ Timing: matmul=0.46s, sample+projlen=8.55s, gather=0.00s, expand=0.01s, other=1.70s, total=10.71s

============================================================
Level 12 - SAMPLING
============================================================
  Starting braids: 500000 (gather: 0.00s)
  Candidates to generate: 3088102 (expand_idx: 0.01s)
  Processing in 62 chunks...
  Projlen distribution:
    projlen=17: 4 braids
    projlen=18: 185 braids
    projlen=19: 2383 braids
    projlen=20: 11320 braids
    projlen=21: 149465 braids
    projlen=22: 282589 braids
    projlen=23: 1762608 braids
    projlen=24: 879548 braids
  Braids kept: 2325494 (in 8 buckets, 20.70 GB)
  ⚡ Timing: matmul=0.50s, sample+projlen=8.74s, gather=0.00s, expand=0.01s, other=1.77s, total=11.04s

============================================================
Level 13 - SAMPLING
============================================================
  Starting braids: 500000 (gather: 0.00s)
  Candidates to generate: 2990900 (expand_idx: 0.01s)
  Processing in 60 chunks...
  Projlen distribution:
    projlen=18: 35 braids
    projlen=19: 157 braids
    projlen=20: 2101 braids
    projlen=21: 22779 braids
    projlen=22: 67605 braids
    projlen=23: 753055 braids
    projlen=24: 1178288 braids
    projlen=25: 854858 braids
    projlen=26: 112022 braids
  Braids kept: 2812612 (in 9 buckets, 25.04 GB)
  ⚡ Timing: matmul=0.49s, sample+projlen=8.12s, gather=0.00s, expand=0.01s, other=1.66s, total=10.28s

============================================================
Level 14 - SAMPLING
============================================================
  Starting braids: 500000 (gather: 0.00s)
  Candidates to generate: 3081570 (expand_idx: 0.02s)
  Processing in 62 chunks...
  Projlen distribution:
    projlen=19: 68 braids
    projlen=20: 479 braids
    projlen=21: 3187 braids
    projlen=22: 16623 braids
    projlen=23: 139707 braids
    projlen=24: 315401 braids
    projlen=25: 1751408 braids
    projlen=26: 854697 braids
  Braids kept: 2330162 (in 8 buckets, 20.74 GB)
  ⚡ Timing: matmul=0.49s, sample+projlen=8.80s, gather=0.00s, expand=0.02s, other=1.83s, total=11.13s

============================================================
Level 15 - SAMPLING
============================================================
  Starting braids: 500000 (gather: 0.00s)
  Candidates to generate: 3026292 (expand_idx: 0.01s)
  Processing in 61 chunks...
  Projlen distribution:
    projlen=19: 44 braids
    projlen=20: 136 braids
    projlen=21: 1254 braids
    projlen=22: 4735 braids
    projlen=23: 28235 braids
    projlen=24: 96639 braids
    projlen=25: 717545 braids
    projlen=26: 1312399 braids
    projlen=27: 814033 braids
    projlen=28: 51272 braids
  Braids kept: 2713893 (in 10 buckets, 24.16 GB)
  ⚡ Timing: matmul=0.47s, sample+projlen=8.26s, gather=0.00s, expand=0.01s, other=1.69s, total=10.42s

============================================================
Level 16 - SAMPLING
============================================================
  Starting braids: 500000 (gather: 0.00s)
  Candidates to generate: 3055640 (expand_idx: 0.01s)
  Processing in 62 chunks...
