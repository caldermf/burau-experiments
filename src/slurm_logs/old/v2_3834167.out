============================================================
SEARCHING FOR p=5 KERNEL ELEMENTS (ULTRA-OPTIMIZED v2)
============================================================
Device: cuda
Bucket size: 1000000
Max length: 60
Bootstrap length: 5
Prime: 5
Degree multiplier: 4
Degree window: 481
Use best: 500000
Expansion chunk size: 50000
Matmul chunk size: 11000
GC every N chunks: 8
⚡ v2 optimizations: reduced GC, fused projlen

Loaded tables from /nfs/roberts/project/pi_com36/com36/burau-experiments/precomputed_tables/tables_B4_r1_p5.pt
  Degree window: 481
✓ Identity matrix verified

Precomputing FFTs of simple Burau matrices...
  D=481, fft_size=1024
  FFT cache: 0.9 MB
Initialized with identity braid
Degree window: [-240, 240] (481 coefficients)
FFT size: 1024
Storage types: matrix=torch.int16, word=torch.int32
Config: bucket_size=1000000, bootstrap=5, max_length=60, chunk_size=50000, matmul_chunk=11000, use_best=500000, gc_every=8
⚡ Ultra-optimized v2: reduced GC, fused projlen

============================================================
Level 1 - BOOTSTRAP
============================================================
  Starting braids: 1 (gather: 0.03s)
  Candidates to generate: 22 (expand_idx: 0.08s)
  Projlen distribution:
    projlen=3: 10 braids
    projlen=4: 12 braids
  Braids kept: 22 (in 2 buckets, 0.00 GB)
  ⚡ Timing: matmul=0.05s, sample+projlen=0.03s, gather=0.03s, expand=0.08s, other=0.05s, total=0.23s

============================================================
Level 2 - BOOTSTRAP
============================================================
  Starting braids: 22 (gather: 0.00s)
  Candidates to generate: 164 (expand_idx: 0.00s)
  Projlen distribution:
    projlen=5: 56 braids
    projlen=6: 76 braids
    projlen=7: 32 braids
  Braids kept: 164 (in 3 buckets, 0.00 GB)
  ⚡ Timing: matmul=0.02s, sample+projlen=0.00s, gather=0.00s, expand=0.00s, other=0.05s, total=0.07s

============================================================
Level 3 - BOOTSTRAP
============================================================
  Starting braids: 164 (gather: 0.00s)
  Candidates to generate: 982 (expand_idx: 0.00s)
  Projlen distribution:
    projlen=7: 270 braids
    projlen=8: 364 braids
    projlen=9: 288 braids
    projlen=10: 60 braids
  Braids kept: 982 (in 4 buckets, 0.01 GB)
  ⚡ Timing: matmul=0.01s, sample+projlen=0.00s, gather=0.00s, expand=0.00s, other=0.05s, total=0.06s

============================================================
Level 4 - BOOTSTRAP
============================================================
  Starting braids: 982 (gather: 0.00s)
  Candidates to generate: 5528 (expand_idx: 0.00s)
  Projlen distribution:
    projlen=9: 1256 braids
    projlen=10: 1672 braids
    projlen=11: 1784 braids
    projlen=12: 700 braids
    projlen=13: 116 braids
  Braids kept: 5528 (in 5 buckets, 0.05 GB)
  ⚡ Timing: matmul=0.02s, sample+projlen=0.00s, gather=0.00s, expand=0.00s, other=0.05s, total=0.07s

============================================================
Level 5 - BOOTSTRAP
============================================================
  Starting braids: 5528 (gather: 0.00s)
  Candidates to generate: 30478 (expand_idx: 0.00s)
  Projlen distribution:
    projlen=10: 4 braids
    projlen=11: 5798 braids
    projlen=12: 7672 braids
    projlen=13: 9864 braids
    projlen=14: 5236 braids
    projlen=15: 1716 braids
    projlen=16: 188 braids
  Braids kept: 30478 (in 7 buckets, 0.27 GB)
  ⚡ Timing: matmul=0.08s, sample+projlen=0.00s, gather=0.00s, expand=0.00s, other=0.06s, total=0.14s

============================================================
Level 6 - SAMPLING
============================================================
  Starting braids: 30478 (gather: 0.00s)
  Candidates to generate: 166796 (expand_idx: 0.00s)
  Processing in 4 chunks...
  Projlen distribution:
    projlen=12: 68 braids
    projlen=13: 26768 braids
    projlen=14: 35288 braids
    projlen=15: 52292 braids
    projlen=16: 33012 braids
    projlen=17: 15680 braids
    projlen=18: 3356 braids
    projlen=19: 332 braids
  Braids kept: 166796 (in 8 buckets, 1.48 GB)
  ⚡ Timing: matmul=0.17s, sample+projlen=0.24s, gather=0.00s, expand=0.00s, other=0.06s, total=0.47s

============================================================
Level 7 - SAMPLING
============================================================
  Starting braids: 166796 (gather: 0.01s)
  Candidates to generate: 910366 (expand_idx: 0.00s)
  Processing in 19 chunks...
  Projlen distribution:
    projlen=13: 52 braids
    projlen=14: 716 braids
    projlen=15: 123766 braids
    projlen=16: 162616 braids
    projlen=17: 271412 braids
    projlen=18: 191940 braids
    projlen=19: 116516 braids
    projlen=20: 35764 braids
    projlen=21: 7076 braids
    projlen=22: 508 braids
  Braids kept: 910366 (in 10 buckets, 8.10 GB)
  ⚡ Timing: matmul=0.12s, sample+projlen=2.18s, gather=0.01s, expand=0.00s, other=0.22s, total=2.53s

============================================================
Level 8 - SAMPLING
============================================================
  Starting braids: 500000 (gather: 0.04s)
  Candidates to generate: 2793512 (expand_idx: 0.00s)
  Processing in 56 chunks...
  Projlen distribution:
    projlen=14: 112 braids
    projlen=15: 892 braids
    projlen=16: 6083 braids
    projlen=17: 567043 braids
    projlen=18: 725733 braids
    projlen=19: 1090567 braids
    projlen=20: 403082 braids
  Braids kept: 2702945 (in 7 buckets, 24.06 GB)
  ⚡ Timing: matmul=0.36s, sample+projlen=7.17s, gather=0.04s, expand=0.00s, other=0.78s, total=8.35s

============================================================
Level 9 - SAMPLING
============================================================
  Starting braids: 500000 (gather: 0.03s)
  Candidates to generate: 2973906 (expand_idx: 0.00s)
  Processing in 60 chunks...
  Projlen distribution:
    projlen=15: 149 braids
    projlen=16: 1282 braids
    projlen=17: 11028 braids
    projlen=18: 33799 braids
    projlen=19: 1949850 braids
    projlen=20: 977798 braids
  Braids kept: 2024056 (in 6 buckets, 18.02 GB)
  ⚡ Timing: matmul=0.35s, sample+projlen=8.12s, gather=0.03s, expand=0.00s, other=0.98s, total=9.48s

============================================================
Level 10 - SAMPLING
============================================================
  Starting braids: 500000 (gather: 0.02s)
  Candidates to generate: 3025676 (expand_idx: 0.00s)
  Processing in 61 chunks...
  Projlen distribution:
    projlen=16: 60 braids
    projlen=17: 2803 braids
    projlen=18: 9718 braids
    projlen=19: 75657 braids
    projlen=20: 151325 braids
    projlen=21: 1861102 braids
    projlen=22: 925011 braids
  Braids kept: 2164574 (in 7 buckets, 19.27 GB)
  ⚡ Timing: matmul=0.36s, sample+projlen=8.28s, gather=0.02s, expand=0.00s, other=1.00s, total=9.67s

============================================================
Level 11 - SAMPLING
============================================================
  Starting braids: 500000 (gather: 0.00s)
  Candidates to generate: 3064228 (expand_idx: 0.01s)
  Processing in 62 chunks...
  Projlen distribution:
    projlen=16: 6 braids
    projlen=17: 88 braids
    projlen=18: 1312 braids
    projlen=19: 24052 braids
    projlen=20: 56668 braids
    projlen=21: 425396 braids
    projlen=22: 651998 braids
    projlen=23: 1364991 braids
    projlen=24: 539717 braids
  Braids kept: 2699237 (in 9 buckets, 24.03 GB)
  ⚡ Timing: matmul=0.33s, sample+projlen=8.36s, gather=0.00s, expand=0.01s, other=0.91s, total=9.61s

============================================================
Level 12 - SAMPLING
============================================================
  Starting braids: 500000 (gather: 0.02s)
  Candidates to generate: 3086516 (expand_idx: 0.00s)
  Processing in 62 chunks...
  Projlen distribution:
    projlen=17: 4 braids
    projlen=18: 189 braids
    projlen=19: 2311 braids
    projlen=20: 11147 braids
    projlen=21: 147760 braids
    projlen=22: 281772 braids
    projlen=23: 1762629 braids
    projlen=24: 880704 braids
  Braids kept: 2323887 (in 8 buckets, 20.69 GB)
  ⚡ Timing: matmul=0.39s, sample+projlen=8.52s, gather=0.02s, expand=0.00s, other=0.98s, total=9.91s

============================================================
Level 13 - SAMPLING
============================================================
  Starting braids: 500000 (gather: 0.00s)
  Candidates to generate: 2990414 (expand_idx: 0.01s)
  Processing in 60 chunks...
  Projlen distribution:
    projlen=18: 34 braids
    projlen=19: 160 braids
    projlen=20: 2055 braids
    projlen=21: 22180 braids
    projlen=22: 66519 braids
    projlen=23: 743517 braids
    projlen=24: 1175024 braids
    projlen=25: 863026 braids
    projlen=26: 117899 braids
  Braids kept: 2815390 (in 9 buckets, 25.06 GB)
  ⚡ Timing: matmul=0.39s, sample+projlen=7.94s, gather=0.00s, expand=0.01s, other=0.96s, total=9.30s

============================================================
Level 14 - SAMPLING
============================================================
  Starting braids: 500000 (gather: 0.03s)
  Candidates to generate: 3082678 (expand_idx: 0.00s)
  Processing in 62 chunks...
  Projlen distribution:
    projlen=19: 66 braids
    projlen=20: 465 braids
    projlen=21: 3038 braids
    projlen=22: 16356 braids
    projlen=23: 136097 braids
    projlen=24: 311193 braids
    projlen=25: 1755944 braids
    projlen=26: 859519 braids
  Braids kept: 2326734 (in 8 buckets, 20.71 GB)
  ⚡ Timing: matmul=0.38s, sample+projlen=8.59s, gather=0.03s, expand=0.00s, other=1.04s, total=10.03s

============================================================
Level 15 - SAMPLING
============================================================
  Starting braids: 500000 (gather: 0.00s)
  Candidates to generate: 3025084 (expand_idx: 0.01s)
  Processing in 61 chunks...
  Projlen distribution:
    projlen=19: 36 braids
    projlen=20: 128 braids
    projlen=21: 1252 braids
    projlen=22: 4597 braids
    projlen=23: 27031 braids
    projlen=24: 94976 braids
    projlen=25: 699146 braids
    projlen=26: 1295470 braids
    projlen=27: 834285 braids
    projlen=28: 68163 braids
  Braids kept: 2729614 (in 10 buckets, 24.30 GB)
  ⚡ Timing: matmul=0.35s, sample+projlen=8.14s, gather=0.00s, expand=0.01s, other=0.98s, total=9.48s

============================================================
Level 16 - SAMPLING
============================================================
  Starting braids: 500000 (gather: 0.03s)
  Candidates to generate: 3051846 (expand_idx: 0.00s)
  Processing in 62 chunks...
  Projlen distribution:
    projlen=20: 63 braids
    projlen=21: 725 braids
    projlen=22: 2131 braids
    projlen=23: 11254 braids
    projlen=24: 33813 braids
    projlen=25: 158646 braids
    projlen=26: 430454 braids
    projlen=27: 1633363 braids
    projlen=28: 781397 braids
  Braids kept: 2418483 (in 9 buckets, 21.53 GB)
  ⚡ Timing: matmul=0.34s, sample+projlen=8.57s, gather=0.03s, expand=0.00s, other=0.97s, total=9.91s

============================================================
Level 17 - SAMPLING
============================================================
  Starting braids: 500000 (gather: 0.02s)
  Candidates to generate: 2999008 (expand_idx: 0.00s)
  Processing in 60 chunks...
