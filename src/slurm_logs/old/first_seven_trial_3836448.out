============================================================
SEARCHING FOR p=7 KERNEL ELEMENTS (ULTRA-OPTIMIZED)
============================================================
Device: cuda
Bucket size: 900000
Max length: 127
Bootstrap length: 5
Prime: 7
Degree multiplier: 4
Degree window: 1017
Use best: 450000
Expansion chunk size: 50000
Matmul chunk size: 10000
⚡ Precomputed FFTs: ENABLED

Loaded tables from /nfs/roberts/project/pi_com36/com36/burau-experiments/precomputed_tables/tables_B4_r1_p7.pt
  Degree window: 1017
✓ Identity matrix verified

Precomputing FFTs of simple Burau matrices...
  D=1017, fft_size=2048
  FFT cache: 1.8 MB
Initialized with identity braid
Degree window: [-508, 508] (1017 coefficients)
FFT size: 2048
Storage types: matrix=torch.int16, word=torch.int32
Config: bucket_size=900000, bootstrap=5, max_length=127, chunk_size=50000, matmul_chunk=10000, use_best=450000
⚡ Ultra-optimized: precomputed Burau FFTs enabled

============================================================
Level 1 - BOOTSTRAP
============================================================
  Starting braids: 1
  Candidates to generate: 22
  Projlen distribution:
    projlen=3: 10 braids
    projlen=4: 12 braids
  Braids kept: 22 (in 2 buckets, 0.00 GB)
  ⚡ Timing: matmul=0.06s, sampling=0.00s, total=0.26s

============================================================
Level 2 - BOOTSTRAP
============================================================
  Starting braids: 22
  Candidates to generate: 164
  Projlen distribution:
    projlen=5: 56 braids
    projlen=6: 76 braids
    projlen=7: 32 braids
  Braids kept: 164 (in 3 buckets, 0.00 GB)
  ⚡ Timing: matmul=0.01s, sampling=0.00s, total=0.11s

============================================================
Level 3 - BOOTSTRAP
============================================================
  Starting braids: 164
  Candidates to generate: 982
  Projlen distribution:
    projlen=7: 270 braids
    projlen=8: 364 braids
    projlen=9: 288 braids
    projlen=10: 60 braids
  Braids kept: 982 (in 4 buckets, 0.02 GB)
  ⚡ Timing: matmul=0.01s, sampling=0.00s, total=0.12s

============================================================
Level 4 - BOOTSTRAP
============================================================
  Starting braids: 982
  Candidates to generate: 5528
  Projlen distribution:
    projlen=9: 1256 braids
    projlen=10: 1672 braids
    projlen=11: 1784 braids
    projlen=12: 700 braids
    projlen=13: 116 braids
  Braids kept: 5528 (in 5 buckets, 0.10 GB)
  ⚡ Timing: matmul=0.03s, sampling=0.00s, total=0.15s

============================================================
Level 5 - BOOTSTRAP
============================================================
  Starting braids: 5528
  Candidates to generate: 30478
  Projlen distribution:
    projlen=10: 4 braids
    projlen=11: 5798 braids
    projlen=12: 7672 braids
    projlen=13: 9864 braids
    projlen=14: 5236 braids
    projlen=15: 1716 braids
    projlen=16: 188 braids
  Braids kept: 30478 (in 7 buckets, 0.57 GB)
  ⚡ Timing: matmul=0.16s, sampling=0.00s, total=0.29s

============================================================
Level 6 - SAMPLING
============================================================
  Starting braids: 30478
  Candidates to generate: 166796
  Processing in 4 chunks...
  Projlen distribution:
    projlen=12: 64 braids
    projlen=13: 26772 braids
    projlen=14: 35288 braids
    projlen=15: 52292 braids
    projlen=16: 33012 braids
    projlen=17: 15680 braids
    projlen=18: 3356 braids
    projlen=19: 332 braids
  Braids kept: 166796 (in 8 buckets, 3.14 GB)
  ⚡ Timing: matmul=0.18s, sampling=0.03s, total=1.25s

============================================================
Level 7 - SAMPLING
============================================================
  Starting braids: 166796
  Candidates to generate: 910366
  Processing in 19 chunks...
  Projlen distribution:
    projlen=13: 52 braids
    projlen=14: 644 braids
    projlen=15: 123806 braids
    projlen=16: 162640 braids
    projlen=17: 271420 braids
    projlen=18: 191940 braids
    projlen=19: 116516 braids
    projlen=20: 35764 braids
    projlen=21: 7076 braids
    projlen=22: 508 braids
  Braids kept: 910366 (in 10 buckets, 17.13 GB)
  ⚡ Timing: matmul=0.73s, sampling=0.46s, total=7.05s

============================================================
Level 8 - SAMPLING
============================================================
  Starting braids: 450000
  Candidates to generate: 2512484
  Processing in 51 chunks...
  Projlen distribution:
    projlen=14: 96 braids
    projlen=15: 872 braids
    projlen=16: 5067 braids
    projlen=17: 564635 braids
    projlen=18: 715408 braids
    projlen=19: 918093 braids
    projlen=20: 308313 braids
  Braids kept: 2494391 (in 7 buckets, 46.94 GB)
  ⚡ Timing: matmul=1.77s, sampling=2.95s, total=22.54s

============================================================
Level 9 - SAMPLING
============================================================
  Starting braids: 450000
  Candidates to generate: 2682188
  Processing in 54 chunks...
  Projlen distribution:
    projlen=15: 137 braids
    projlen=16: 1065 braids
    projlen=17: 9448 braids
    projlen=18: 26664 braids
    projlen=19: 1761527 braids
    projlen=20: 883347 braids
  Braids kept: 1820661 (in 6 buckets, 34.26 GB)
  ⚡ Timing: matmul=1.94s, sampling=4.85s, total=26.85s

============================================================
Level 10 - SAMPLING
============================================================
  Starting braids: 450000
  Candidates to generate: 2720172
  Processing in 55 chunks...
  Projlen distribution:
    projlen=16: 14 braids
    projlen=17: 2312 braids
    projlen=18: 7507 braids
    projlen=19: 62091 braids
    projlen=20: 120335 braids
    projlen=21: 1685491 braids
    projlen=22: 842422 braids
  Braids kept: 1934681 (in 7 buckets, 36.41 GB)
  ⚡ Timing: matmul=1.97s, sampling=5.02s, total=27.29s

============================================================
Level 11 - SAMPLING
============================================================
  Starting braids: 450000
  Candidates to generate: 2743960
  Processing in 55 chunks...
  Projlen distribution:
    projlen=17: 30 braids
    projlen=18: 498 braids
    projlen=19: 18508 braids
    projlen=20: 42992 braids
    projlen=21: 345429 braids
    projlen=22: 519741 braids
    projlen=23: 1282590 braids
    projlen=24: 534172 braids
  Braids kept: 2361370 (in 8 buckets, 44.44 GB)
  ⚡ Timing: matmul=2.10s, sampling=4.67s, total=26.36s

============================================================
Level 12 - SAMPLING
============================================================
  Starting braids: 450000
  Candidates to generate: 2746430
  Processing in 55 chunks...
  Projlen distribution:
    projlen=18: 36 braids
    projlen=19: 784 braids
    projlen=20: 4808 braids
    projlen=21: 112403 braids
    projlen=22: 212300 braids
    projlen=23: 1471936 braids
    projlen=24: 846857 braids
    projlen=25: 97306 braids
  Braids kept: 2174494 (in 8 buckets, 40.92 GB)
  ⚡ Timing: matmul=2.08s, sampling=5.36s, total=27.76s

============================================================
Level 13 - SAMPLING
============================================================
  Starting braids: 450000
  Candidates to generate: 2680536
  Processing in 54 chunks...
  Projlen distribution:
    projlen=19: 39 braids
    projlen=20: 534 braids
    projlen=21: 8907 braids
    projlen=22: 29629 braids
    projlen=23: 561852 braids
    projlen=24: 889276 braids
    projlen=25: 942749 braids
    projlen=26: 247550 braids
  Braids kept: 2637787 (in 8 buckets, 49.64 GB)
  ⚡ Timing: matmul=1.90s, sampling=3.40s, total=23.99s

============================================================
Level 14 - SAMPLING
============================================================
  Starting braids: 450000
  Candidates to generate: 2767980
  Processing in 56 chunks...
  Projlen distribution:
    projlen=20: 22 braids
    projlen=21: 1087 braids
    projlen=22: 4836 braids
    projlen=23: 57674 braids
    projlen=24: 146136 braids
    projlen=25: 1696364 braids
    projlen=26: 861861 braids
  Braids kept: 1971616 (in 7 buckets, 37.10 GB)
  ⚡ Timing: matmul=2.03s, sampling=5.02s, total=27.70s

============================================================
Level 15 - SAMPLING
============================================================
  Starting braids: 450000
  Candidates to generate: 2731130
  Processing in 55 chunks...
  Projlen distribution:
    projlen=21: 77 braids
    projlen=22: 392 braids
    projlen=23: 9352 braids
    projlen=24: 27864 braids
    projlen=25: 304304 braids
    projlen=26: 620496 braids
    projlen=27: 1265922 braids
    projlen=28: 502723 braids
  Braids kept: 2365208 (in 8 buckets, 44.51 GB)
  ⚡ Timing: matmul=2.02s, sampling=4.78s, total=26.83s

============================================================
Level 16 - SAMPLING
============================================================
  Starting braids: 450000
  Candidates to generate: 2725158
  Processing in 55 chunks...
  Projlen distribution:
    projlen=22: 1 braids
    projlen=23: 944 braids
    projlen=24: 3714 braids
    projlen=25: 54047 braids
    projlen=26: 142783 braids
    projlen=27: 1295763 braids
    projlen=28: 986066 braids
    projlen=29: 241840 braids
  Braids kept: 2243329 (in 8 buckets, 42.21 GB)
  ⚡ Timing: matmul=2.06s, sampling=5.31s, total=28.51s

============================================================
Level 17 - SAMPLING
============================================================
  Starting braids: 450000
  Candidates to generate: 2708910
  Processing in 55 chunks...
  Projlen distribution:
    projlen=23: 4 braids
    projlen=24: 293 braids
    projlen=25: 7699 braids
    projlen=26: 23546 braids
    projlen=27: 274476 braids
    projlen=28: 608550 braids
    projlen=29: 1273762 braids
    projlen=30: 520580 braids
  Braids kept: 2335148 (in 8 buckets, 43.94 GB)
  ⚡ Timing: matmul=2.23s, sampling=5.09s, total=28.12s

============================================================
Level 18 - SAMPLING
============================================================
  Starting braids: 450000
  Candidates to generate: 2710140
  Processing in 55 chunks...
  Projlen distribution:
    projlen=23: 2 braids
    projlen=24: 38 braids
    projlen=25: 973 braids
    projlen=26: 4024 braids
    projlen=27: 49394 braids
    projlen=28: 126232 braids
    projlen=29: 1171383 braids
    projlen=30: 1039424 braids
    projlen=31: 318670 braids
  Braids kept: 2299333 (in 9 buckets, 43.27 GB)
  ⚡ Timing: matmul=2.04s, sampling=5.30s, total=28.39s

============================================================
Level 19 - SAMPLING
============================================================
  Starting braids: 450000
  Candidates to generate: 2730414
  Processing in 55 chunks...
  Projlen distribution:
    projlen=24: 17 braids
    projlen=25: 266 braids
    projlen=26: 1283 braids
    projlen=27: 11170 braids
    projlen=28: 29287 braids
    projlen=29: 262747 braids
    projlen=30: 547205 braids
    projlen=31: 1314913 braids
    projlen=32: 563526 braids
  Braids kept: 2315501 (in 9 buckets, 43.57 GB)
  ⚡ Timing: matmul=2.14s, sampling=4.83s, total=27.53s

============================================================
Level 20 - SAMPLING
============================================================
  Starting braids: 450000
  Candidates to generate: 2739124
  Processing in 55 chunks...
  Projlen distribution:
    projlen=23: 4 braids
    projlen=24: 15 braids
    projlen=25: 91 braids
    projlen=26: 354 braids
    projlen=27: 3443 braids
    projlen=28: 11441 braids
    projlen=29: 78456 braids
    projlen=30: 158113 braids
    projlen=31: 1147330 braids
    projlen=32: 1018702 braids
  Braids kept: 2373092 (in 11 buckets, 44.66 GB)
  ⚡ Timing: matmul=2.19s, sampling=5.69s, total=29.41s

============================================================
Level 21 - SAMPLING
============================================================
  Starting braids: 450000
  Candidates to generate: 2732902
  Processing in 55 chunks...
  Projlen distribution:
    projlen=23: 6 braids
    projlen=24: 12 braids
    projlen=25: 54 braids
    projlen=26: 190 braids
    projlen=27: 1041 braids
    projlen=28: 3356 braids
    projlen=29: 27559 braids
    projlen=30: 68122 braids
    projlen=31: 420460 braids
    projlen=32: 687674 braids
  Braids kept: 2520933 (in 12 buckets, 47.44 GB)
  ⚡ Timing: matmul=2.08s, sampling=4.99s, total=27.46s

============================================================
Level 22 - SAMPLING
============================================================
  Starting braids: 450000
  Candidates to generate: 2763470
  Processing in 56 chunks...
  Projlen distribution:
    projlen=25: 46 braids
    projlen=26: 106 braids
    projlen=27: 490 braids
    projlen=28: 1569 braids
    projlen=29: 8763 braids
    projlen=30: 21716 braids
    projlen=31: 158948 braids
    projlen=32: 329524 braids
    projlen=33: 1498643 braids
    projlen=34: 743665 braids
  Braids kept: 2164827 (in 10 buckets, 40.74 GB)
  ⚡ Timing: matmul=2.23s, sampling=6.38s, total=29.84s

============================================================
Level 23 - SAMPLING
============================================================
  Starting braids: 450000
  Candidates to generate: 2676556
  Processing in 54 chunks...
  Projlen distribution:
    projlen=26: 8 braids
    projlen=27: 315 braids
    projlen=28: 750 braids
    projlen=29: 3604 braids
    projlen=30: 10442 braids
    projlen=31: 54669 braids
    projlen=32: 113517 braids
    projlen=33: 758087 braids
    projlen=34: 1158908 braids
    projlen=35: 576256 braids
  Braids kept: 2417648 (in 10 buckets, 45.50 GB)
  ⚡ Timing: matmul=2.08s, sampling=4.00s, total=26.34s

============================================================
Level 24 - SAMPLING
============================================================
  Starting braids: 450000
  Candidates to generate: 2688074
  Processing in 54 chunks...
  Projlen distribution:
    projlen=26: 8 braids
    projlen=27: 25 braids
    projlen=28: 230 braids
    projlen=29: 2021 braids
    projlen=30: 4771 braids
    projlen=31: 22571 braids
    projlen=32: 55814 braids
    projlen=33: 275634 braids
    projlen=34: 499738 braids
    projlen=35: 1268307 braids
  Braids kept: 2319767 (in 11 buckets, 43.65 GB)
  ⚡ Timing: matmul=2.10s, sampling=4.86s, total=27.06s

============================================================
Level 25 - SAMPLING
============================================================
  Starting braids: 450000
  Candidates to generate: 2649762
  Processing in 53 chunks...
  Projlen distribution:
    projlen=27: 37 braids
    projlen=28: 82 braids
    projlen=29: 505 braids
    projlen=30: 1898 braids
    projlen=31: 12463 braids
    projlen=32: 25984 braids
    projlen=33: 117453 braids
    projlen=34: 265913 braids
    projlen=35: 1176536 braids
    projlen=36: 854355 braids
  Braids kept: 2373226 (in 11 buckets, 44.66 GB)
  ⚡ Timing: matmul=2.09s, sampling=4.85s, total=27.15s

============================================================
Level 26 - SAMPLING
============================================================
  Starting braids: 450000
  Candidates to generate: 2594296
  Processing in 52 chunks...
  Projlen distribution:
    projlen=26: 4 braids
    projlen=27: 16 braids
    projlen=28: 39 braids
    projlen=29: 448 braids
    projlen=30: 743 braids
    projlen=31: 4340 braids
    projlen=32: 11744 braids
    projlen=33: 68175 braids
    projlen=34: 126703 braids
    projlen=35: 551643 braids
  Braids kept: 2381002 (in 13 buckets, 44.81 GB)
  ⚡ Timing: matmul=2.03s, sampling=4.20s, total=25.33s

============================================================
Level 27 - SAMPLING
============================================================
  Starting braids: 450000
  Candidates to generate: 2608550
  Processing in 53 chunks...
  Projlen distribution:
    projlen=27: 18 braids
    projlen=28: 30 braids
    projlen=29: 209 braids
    projlen=30: 374 braids
    projlen=31: 3315 braids
    projlen=32: 5072 braids
    projlen=33: 28067 braids
    projlen=34: 63139 braids
    projlen=35: 325319 braids
    projlen=36: 548135 braids
  Braids kept: 2359428 (in 12 buckets, 44.40 GB)
  ⚡ Timing: matmul=1.96s, sampling=4.41s, total=25.92s

============================================================
Level 28 - SAMPLING
============================================================
  Starting braids: 450000
  Candidates to generate: 2643848
  Processing in 53 chunks...
  Projlen distribution:
    projlen=27: 13 braids
    projlen=28: 25 braids
    projlen=29: 168 braids
    projlen=30: 247 braids
    projlen=31: 1608 braids
    projlen=32: 2617 braids
    projlen=33: 20300 braids
    projlen=34: 29693 braids
    projlen=35: 151441 braids
    projlen=36: 298450 braids
  Braids kept: 2195228 (in 13 buckets, 41.31 GB)
  ⚡ Timing: matmul=2.08s, sampling=4.86s, total=26.90s

============================================================
Level 29 - SAMPLING
============================================================
  Starting braids: 450000
  Candidates to generate: 2610716
  Processing in 53 chunks...
  Projlen distribution:
    projlen=27: 1 braids
    projlen=28: 8 braids
    projlen=29: 116 braids
    projlen=30: 185 braids
    projlen=31: 1168 braids
    projlen=32: 1729 braids
    projlen=33: 10405 braids
    projlen=34: 16209 braids
    projlen=35: 110536 braids
    projlen=36: 148407 braids
  Braids kept: 2432577 (in 13 buckets, 45.78 GB)
  ⚡ Timing: matmul=1.91s, sampling=4.67s, total=26.03s

============================================================
Level 30 - SAMPLING
============================================================
  Starting braids: 450000
  Candidates to generate: 2600450
  Processing in 53 chunks...

============================================================
SEARCH STOPPED
============================================================
Final level: 29
Total time: 626.56s
Avg time per level: 21.61s
Total matmul time: 46.20s
Total kernel elements: 0
  Saving checkpoint to ./final_state_level_29.pt...

Final state saved to ./final_state_level_29.pt
