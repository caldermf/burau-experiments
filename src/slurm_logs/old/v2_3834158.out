============================================================
SEARCHING FOR p=5 KERNEL ELEMENTS (ULTRA-OPTIMIZED v2)
============================================================
Device: cuda
Bucket size: 800000
Max length: 60
Bootstrap length: 5
Prime: 5
Degree multiplier: 4
Degree window: 481
Use best: 400000
Expansion chunk size: 50000
Matmul chunk size: 9000
GC every N chunks: 10
⚡ v2 optimizations: reduced GC, fused projlen

Loaded tables from /nfs/roberts/project/pi_com36/com36/burau-experiments/precomputed_tables/tables_B4_r1_p5.pt
  Degree window: 481
✓ Identity matrix verified

Precomputing FFTs of simple Burau matrices...
  D=481, fft_size=1024
  FFT cache: 0.9 MB
Initialized with identity braid
Degree window: [-240, 240] (481 coefficients)
FFT size: 1024
Storage types: matrix=torch.int16, word=torch.int32
Config: bucket_size=800000, bootstrap=5, max_length=60, chunk_size=50000, matmul_chunk=9000, use_best=400000, gc_every=10
⚡ Ultra-optimized v2: reduced GC, fused projlen

============================================================
Level 1 - BOOTSTRAP
============================================================
  Starting braids: 1 (gather: 0.08s)
  Candidates to generate: 22 (expand_idx: 0.12s)
  Projlen distribution:
    projlen=3: 10 braids
    projlen=4: 12 braids
  Braids kept: 22 (in 2 buckets, 0.00 GB)
  ⚡ Timing: matmul=0.11s, sample+projlen=0.10s, gather=0.08s, expand=0.12s, other=0.05s, total=0.45s

============================================================
Level 2 - BOOTSTRAP
============================================================
  Starting braids: 22 (gather: 0.01s)
  Candidates to generate: 164 (expand_idx: 0.00s)
  Projlen distribution:
    projlen=5: 56 braids
    projlen=6: 76 braids
    projlen=7: 32 braids
  Braids kept: 164 (in 3 buckets, 0.00 GB)
  ⚡ Timing: matmul=0.01s, sample+projlen=0.00s, gather=0.01s, expand=0.00s, other=0.05s, total=0.06s

============================================================
Level 3 - BOOTSTRAP
============================================================
  Starting braids: 164 (gather: 0.00s)
  Candidates to generate: 982 (expand_idx: 0.00s)
  Projlen distribution:
    projlen=7: 270 braids
    projlen=8: 364 braids
    projlen=9: 288 braids
    projlen=10: 60 braids
  Braids kept: 982 (in 4 buckets, 0.01 GB)
  ⚡ Timing: matmul=0.02s, sample+projlen=0.00s, gather=0.00s, expand=0.00s, other=0.05s, total=0.07s

============================================================
Level 4 - BOOTSTRAP
============================================================
  Starting braids: 982 (gather: 0.00s)
  Candidates to generate: 5528 (expand_idx: 0.00s)
  Projlen distribution:
    projlen=9: 1256 braids
    projlen=10: 1672 braids
    projlen=11: 1784 braids
    projlen=12: 700 braids
    projlen=13: 116 braids
  Braids kept: 5528 (in 5 buckets, 0.05 GB)
  ⚡ Timing: matmul=0.02s, sample+projlen=0.00s, gather=0.00s, expand=0.00s, other=0.05s, total=0.08s

============================================================
Level 5 - BOOTSTRAP
============================================================
  Starting braids: 5528 (gather: 0.00s)
  Candidates to generate: 30478 (expand_idx: 0.00s)
  Projlen distribution:
    projlen=10: 4 braids
    projlen=11: 5798 braids
    projlen=12: 7672 braids
    projlen=13: 9864 braids
    projlen=14: 5236 braids
    projlen=15: 1716 braids
    projlen=16: 188 braids
  Braids kept: 30478 (in 7 buckets, 0.27 GB)
  ⚡ Timing: matmul=0.08s, sample+projlen=0.00s, gather=0.00s, expand=0.00s, other=0.06s, total=0.14s

============================================================
Level 6 - SAMPLING
============================================================
  Starting braids: 30478 (gather: 0.00s)
  Candidates to generate: 166796 (expand_idx: 0.00s)
  Processing in 4 chunks...
  Projlen distribution:
    projlen=12: 68 braids
    projlen=13: 26768 braids
    projlen=14: 35288 braids
    projlen=15: 52292 braids
    projlen=16: 33012 braids
    projlen=17: 15680 braids
    projlen=18: 3356 braids
    projlen=19: 332 braids
  Braids kept: 166796 (in 8 buckets, 1.48 GB)
  ⚡ Timing: matmul=0.21s, sample+projlen=0.23s, gather=0.00s, expand=0.00s, other=0.39s, total=0.84s

============================================================
Level 7 - SAMPLING
============================================================
  Starting braids: 166796 (gather: 0.02s)
  Candidates to generate: 910366 (expand_idx: 0.00s)
  Processing in 19 chunks...
  Projlen distribution:
    projlen=13: 52 braids
    projlen=14: 716 braids
    projlen=15: 123766 braids
    projlen=16: 162616 braids
    projlen=17: 271412 braids
    projlen=18: 191940 braids
    projlen=19: 116516 braids
    projlen=20: 35764 braids
    projlen=21: 7076 braids
    projlen=22: 508 braids
  Braids kept: 910366 (in 10 buckets, 8.10 GB)
  ⚡ Timing: matmul=0.12s, sample+projlen=2.30s, gather=0.02s, expand=0.00s, other=0.16s, total=2.60s

============================================================
Level 8 - SAMPLING
============================================================
  Starting braids: 400000 (gather: 0.04s)
  Candidates to generate: 2230202 (expand_idx: 0.00s)
  Processing in 45 chunks...
  Projlen distribution:
    projlen=14: 112 braids
    projlen=15: 892 braids
    projlen=16: 5655 braids
    projlen=17: 562045 braids
    projlen=18: 704339 braids
    projlen=19: 743766 braids
    projlen=20: 213393 braids
  Braids kept: 2230202 (in 7 buckets, 19.85 GB)
  ⚡ Timing: matmul=0.28s, sample+projlen=5.52s, gather=0.04s, expand=0.00s, other=0.53s, total=6.37s

============================================================
Level 9 - SAMPLING
============================================================
  Starting braids: 400000 (gather: 0.02s)
  Candidates to generate: 2387836 (expand_idx: 0.00s)
  Processing in 48 chunks...
  Projlen distribution:
    projlen=15: 147 braids
    projlen=16: 1160 braids
    projlen=17: 9930 braids
    projlen=18: 30727 braids
    projlen=19: 1562665 braids
    projlen=20: 783207 braids
  Braids kept: 1625171 (in 6 buckets, 14.47 GB)
  ⚡ Timing: matmul=0.30s, sample+projlen=6.58s, gather=0.02s, expand=0.00s, other=0.93s, total=7.84s

============================================================
Level 10 - SAMPLING
============================================================
  Starting braids: 400000 (gather: 0.02s)
  Candidates to generate: 2426534 (expand_idx: 0.00s)
  Processing in 49 chunks...
  Projlen distribution:
    projlen=16: 56 braids
    projlen=17: 2490 braids
    projlen=18: 8762 braids
    projlen=19: 68204 braids
    projlen=20: 136666 braids
    projlen=21: 1478656 braids
    projlen=22: 731700 braids
  Braids kept: 1747878 (in 7 buckets, 15.56 GB)
  ⚡ Timing: matmul=0.28s, sample+projlen=6.41s, gather=0.02s, expand=0.00s, other=0.64s, total=7.36s

============================================================
Level 11 - SAMPLING
============================================================
  Starting braids: 400000 (gather: 0.00s)
  Candidates to generate: 2451034 (expand_idx: 0.01s)
  Processing in 50 chunks...
  Projlen distribution:
    projlen=16: 6 braids
    projlen=17: 74 braids
    projlen=18: 1178 braids
    projlen=19: 21312 braids
    projlen=20: 50701 braids
    projlen=21: 378520 braids
    projlen=22: 587023 braids
    projlen=23: 1031283 braids
    projlen=24: 380937 braids
  Braids kept: 2219751 (in 9 buckets, 19.76 GB)
  ⚡ Timing: matmul=0.23s, sample+projlen=6.72s, gather=0.00s, expand=0.01s, other=0.56s, total=7.52s

============================================================
Level 12 - SAMPLING
============================================================
  Starting braids: 400000 (gather: 0.00s)
  Candidates to generate: 2462058 (expand_idx: 0.02s)
  Processing in 50 chunks...
  Projlen distribution:
    projlen=17: 4 braids
    projlen=18: 157 braids
    projlen=19: 2018 braids
    projlen=20: 9743 braids
    projlen=21: 128606 braids
    projlen=22: 246171 braids
    projlen=23: 1390070 braids
    projlen=24: 685289 braids
  Braids kept: 1871988 (in 8 buckets, 16.66 GB)
  ⚡ Timing: matmul=0.25s, sample+projlen=6.66s, gather=0.00s, expand=0.02s, other=0.58s, total=7.51s

============================================================
Level 13 - SAMPLING
============================================================
  Starting braids: 400000 (gather: 0.00s)
  Candidates to generate: 2392238 (expand_idx: 0.01s)
  Processing in 48 chunks...
  Projlen distribution:
    projlen=18: 34 braids
    projlen=19: 140 braids
    projlen=20: 1745 braids
    projlen=21: 19065 braids
    projlen=22: 57696 braids
    projlen=23: 644830 braids
    projlen=24: 1024272 braids
    projlen=25: 616507 braids
    projlen=26: 27949 braids
  Braids kept: 2167966 (in 9 buckets, 19.30 GB)
  ⚡ Timing: matmul=0.31s, sample+projlen=6.24s, gather=0.00s, expand=0.01s, other=0.88s, total=7.43s

============================================================
Level 14 - SAMPLING
============================================================
  Starting braids: 400000 (gather: 0.00s)
  Candidates to generate: 2463150 (expand_idx: 0.02s)
  Processing in 50 chunks...
  Projlen distribution:
    projlen=19: 64 braids
    projlen=20: 463 braids
    projlen=21: 2728 braids
    projlen=22: 13838 braids
    projlen=23: 115679 braids
    projlen=24: 266694 braids
    projlen=25: 1389976 braids
    projlen=26: 673708 braids
  Braids kept: 1873174 (in 8 buckets, 16.67 GB)
  ⚡ Timing: matmul=0.26s, sample+projlen=6.73s, gather=0.00s, expand=0.02s, other=0.60s, total=7.60s

============================================================
Level 15 - SAMPLING
============================================================
  Starting braids: 400000 (gather: 0.00s)
  Candidates to generate: 2418008 (expand_idx: 0.01s)
  Processing in 49 chunks...
  Projlen distribution:
    projlen=19: 31 braids
    projlen=20: 120 braids
    projlen=21: 1201 braids
    projlen=22: 4299 braids
    projlen=23: 23607 braids
    projlen=24: 79548 braids
    projlen=25: 591466 braids
    projlen=26: 1106579 braids
    projlen=27: 610058 braids
    projlen=28: 1099 braids
  Braids kept: 2111429 (in 10 buckets, 18.80 GB)
  ⚡ Timing: matmul=0.27s, sample+projlen=6.60s, gather=0.00s, expand=0.01s, other=0.62s, total=7.50s

============================================================
Level 16 - SAMPLING
============================================================
  Starting braids: 400000 (gather: 0.02s)
  Candidates to generate: 2440984 (expand_idx: 0.00s)
  Processing in 49 chunks...
  Projlen distribution:
    projlen=20: 66 braids
    projlen=21: 673 braids
    projlen=22: 1906 braids
    projlen=23: 10444 braids
    projlen=24: 30523 braids
    projlen=25: 135895 braids
    projlen=26: 357680 braids
    projlen=27: 1291809 braids
    projlen=28: 611988 braids
  Braids kept: 1949175 (in 9 buckets, 17.35 GB)
  ⚡ Timing: matmul=0.32s, sample+projlen=6.60s, gather=0.02s, expand=0.00s, other=0.72s, total=7.66s

============================================================
Level 17 - SAMPLING
============================================================
  Starting braids: 400000 (gather: 0.02s)
  Candidates to generate: 2393758 (expand_idx: 0.00s)
  Processing in 48 chunks...
  Projlen distribution:
    projlen=20: 30 braids
    projlen=21: 246 braids
    projlen=22: 1184 braids
    projlen=23: 6226 braids
    projlen=24: 15398 braids
    projlen=25: 68821 braids
    projlen=26: 160537 braids
    projlen=27: 635078 braids
    projlen=28: 1024722 braids
    projlen=29: 481516 braids
  Braids kept: 2169036 (in 10 buckets, 19.31 GB)
  ⚡ Timing: matmul=0.32s, sample+projlen=6.23s, gather=0.02s, expand=0.00s, other=0.87s, total=7.45s

============================================================
Level 18 - SAMPLING
============================================================
  Starting braids: 400000 (gather: 0.00s)
  Candidates to generate: 2380640 (expand_idx: 0.01s)
  Processing in 48 chunks...
  Projlen distribution:
    projlen=21: 79 braids
    projlen=22: 572 braids
    projlen=23: 3490 braids
    projlen=24: 10528 braids
    projlen=25: 44961 braids
    projlen=26: 91089 braids
    projlen=27: 346465 braids
    projlen=28: 692139 braids
    projlen=29: 882217 braids
    projlen=30: 309100 braids
  Braids kept: 2298423 (in 10 buckets, 20.46 GB)
  ⚡ Timing: matmul=0.29s, sample+projlen=6.23s, gather=0.00s, expand=0.01s, other=0.60s, total=7.13s

============================================================
Level 19 - SAMPLING
============================================================
  Starting braids: 400000 (gather: 0.02s)
  Candidates to generate: 2381854 (expand_idx: 0.00s)
  Processing in 48 chunks...
